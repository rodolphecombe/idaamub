#textdomain wesnoth-loi

#define UNIT_IN_A_BOX X Y TYPE
	{PLACE_IMAGE items/box.png {X} {Y}}
	[event]
		name=enter_hex
		first_time_only=yes
		[filter]
			side=1
			[filter_location]
				x={X}
				y={Y}
				radius=2
			[/filter_location]
		[/filter]
		{REMOVE_IMAGE {X} {Y}}
		[unit]
			type={TYPE}
			x={X}
			y={Y}
			side=2
		[/unit]
		[message]
			speaker=unit
			message= _ "There was an enemy hidden in this box."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]
#enddef

#define FAKE_WALL X Y TYPE
	[event]
		name=enter_hex
		[filter]
			side=1
			[filter_location]
				x={X}
				y={Y}
				radius=2
			[/filter_location]
		[/filter]
		[terrain]
			x={X}
			y={Y}
			terrain=Irs
		[/terrain] 
		[unit]
			type={TYPE}
			x={X}
			y={Y}
			side=2
		[/unit] 
		[redraw]
			side=1
		[/redraw]
		[message]
			speaker=unit
			message="The wall was actually a door. There is an enemy inside."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]
#enddef

#define FAKE_WALL_2 X1 Y1 X2 Y2 TYPE1 TYPE2
	[event]
		name=enter_hex
		[filter]
			side=1
			[filter_location]
				x={X1},{X2}
				y={Y1},{Y2}
				radius=2
			[/filter_location]
		[/filter]
		[terrain]
			x={X1},{X2}
			y={Y1},{Y2}
			terrain=Irs
		[/terrain] 
		[unit]
			type={TYPE1}
			x={X1}
			y={Y1}
			side=2
		[/unit] 
		[unit]
			type={TYPE2}
			x={X2}
			y={Y2}
			side=2
		[/unit] 
		[redraw]
			side=1
		[/redraw]
		[message]
			speaker=unit
			message="The wall was actually a door. There are enemies inside."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]
#enddef

[scenario]
	id="33_Goblins_Lair"
	name= _ "Goblin's Lair"
	map_data="{~add-ons/Legends_of_Idaamub/maps/33_Goblins_Lair.map}"
	victory_when_enemies_defeated=no
	next_scenario=34_Hive
	{TURNS 110 100 90}

	{UNDERGROUND}

	[item]
		halo="scenery/flames[01~15].png"
		image="scenery/flames01.png"
		visible_in_fog=yes
		x=6
		y=35
	[/item]
	{PLACE_IMAGE items/ball-magenta.png 4 36}

	[event]
		name=prestart
		
		[set_variable]
			name=scenario_number
			value=33
		[/set_variable]

		{VARIABLE trap_activated 1}
		{VARIABLE bridge_orientation 1}

		[objectives]
			side=1
			[objective]
				description= _ "Find the protection staff"
				condition=win
			[/objective]
			{FOOD_OBJECTIVES}
			[objective]
				description= _ "Death of Io"
				condition=lose
			[/objective]
			{TURNS_RUN_OUT}

			[gold_carryover]
				bonus=yes
				carryover_percentage=100
			[/gold_carryover]
		[/objectives]

		{LOI_RECALL_ALL 3 71}

	[/event]

	[side]
		type="Young Man"
		id=Io
		name= _ "Io"
		x=3
		y=71
		fog=yes
		shroud=yes
		side=1
		canrecruit=yes
		profile=portraits/Io.png
		controller=human
		team_name=heroes
		user_team_name=_"Heroes"
		
	[/side]

	[side]
		no_leader=yes
		fog=no
		shroud=no
		side=2
		team_name=goblins
		user_team_name="Goblins"
		[unit]
			ai_special=guardian
			name="Tog"
			type="Goblin Chieftain"
			x=4
			y=59
		[/unit]
		[unit]
			ai_special=guardian
			name="Grutib"
			type="Goblin Chieftain"
			x=4
			y=63
		[/unit]
		[unit]
			ai_special=guardian
			name="Abo"
			type="Goblin Chieftain"
			x=4
			y=65
		[/unit]
		[unit]
			ai_special=guardian
			name="Ukhrug"
			type="Goblin Chieftain"
			x=3
			y=60
		[/unit]
		[unit]
			ai_special=guardian
			name="Pinu"
			type="Goblin Chieftain"
			x=4
			y=62
		[/unit]
		[unit]
			ai_special=guardian
			name="Irbu"
			type="Goblin Chieftain"
			x=3
			y=58
		[/unit]
		[unit]
			ai_special=guardian
			name="Bash"
			type="Goblin Chieftain"
			x=4
			y=64
		[/unit]
		[unit]
			ai_special=guardian
			name="Runu"
			type="Goblin Chieftain"
			x=4
			y=58
		[/unit]
		[unit]
			ai_special=guardian
			name="Uso"
			type="Goblin Chieftain"
			x=3
			y=57
		[/unit]
		[unit]
			ai_special=guardian
			name="Ghor"
			type="Goblin Spearmaster"
			x=3
			y=59
		[/unit]
		[unit]
			ai_special=guardian
			name="Omub"
			type="Goblin Spearmaster"
			x=4
			y=61
		[/unit]
		[unit]
			ai_special=guardian
			name="Rudru"
			type="Goblin Spearmaster"
			x=3
			y=62
		[/unit]
		[unit]
			ai_special=guardian
			name="Gavro"
			type="Goblin Spearmaster"
			x=4
			y=60
		[/unit]
		[unit]
			ai_special=guardian
			name="Pudru"
			type="Goblin Spearmaster"
			x=4
			y=57
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Skewer"
			x=3
			y=61
		[/unit]
		[unit]
			ai_special=guardian
			name="Igzik"
			type="Goblin Chieftain"
			x=5
			y=54
		[/unit]
		[unit]
			ai_special=guardian
			name="Akho"
			type="Goblin Chieftain"
			x=4
			y=53
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-14"
			type="Steel Vector"
			x=6
			y=49
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Vector"
			x=7
			y=55
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-45"
			type="Steel Vector"
			x=7
			y=54
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-81"
			type="Steel Vector"
			x=9
			y=53
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-37"
			type="Steel Vector"
			x=5
			y=55
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Vector"
			x=3
			y=53
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-37"
			type="Steel Vector"
			x=3
			y=52
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-48"
			type="Steel Vector"
			x=5
			y=50
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-3"
			type="Steel Vector"
			x=4
			y=49
		[/unit]
		[unit]
			ai_special=guardian
			name="Bog"
			type="Goblin Spearmaster"
			x=9
			y=54
		[/unit]
		[unit]
			ai_special=guardian
			name="Brushnu"
			type="Goblin Spearmaster"
			x=8
			y=52
		[/unit]
		[unit]
			ai_special=guardian
			name="Udro"
			type="Goblin Spearmaster"
			x=3
			y=51
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-80"
			type="Steel Skewer"
			x=6
			y=55
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-81"
			type="Steel Skewer"
			x=7
			y=50
		[/unit]
		[unit]
			ai_special=guardian
			name="Pikhu"
			type="Goblin Spearmaster"
			x=8
			y=36
		[/unit]
		[unit]
			ai_special=guardian
			name="Rugrur"
			type="Goblin Spearmaster"
			x=7
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			name="Odo"
			type="Goblin Spearmaster"
			x=4
			y=46
		[/unit]
		[unit]
			ai_special=guardian
			name="Shitosh"
			type="Goblin Spearmaster"
			x=9
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Goro"
			type="Goblin Spearmaster"
			x=2
			y=46
		[/unit]
		[unit]
			ai_special=guardian
			name="Pur"
			type="Goblin Spearmaster"
			x=18
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Urbu"
			type="Goblin Spearmaster"
			x=7
			y=38
		[/unit]
		[unit]
			ai_special=guardian
			name="Baro"
			type="Goblin Spearmaster"
			x=6
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=7
			y=29
		[/unit]
		[unit]
			ai_special=guardian
			name="Shur"
			type="Goblin Chieftain"
			x=20
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="Bobo"
			type="Goblin Chieftain"
			x=19
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			name="Ugzu"
			type="Goblin Chieftain"
			x=7
			y=30
		[/unit]
		[unit]
			ai_special=guardian
			name="Sok"
			type="Goblin Chieftain"
			x=7
			y=35
		[/unit]
		[unit]
			ai_special=guardian
			name="Gigdo"
			type="Goblin Chieftain"
			x=6
			y=36
		[/unit]
		[unit]
			ai_special=guardian
			name="Mug"
			type="Goblin Chieftain"
			x=5
			y=37
		[/unit]
		[unit]
			ai_special=guardian
			name="Sapo"
			type="Goblin Chieftain"
			x=6
			y=37
		[/unit]
		[unit]
			ai_special=guardian
			name="Tog"
			type="Goblin Chieftain"
			x=7
			y=43
		[/unit]
		[unit]
			ai_special=guardian
			name="Ozgo"
			type="Goblin Chieftain"
			x=17
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Bughu"
			type="Goblin Chieftain"
			x=7
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Abro"
			type="Goblin Chieftain"
			x=2
			y=47
		[/unit]
		[unit]
			ai_special=guardian
			name="Tab"
			type="Goblin Chieftain"
			x=19
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=1
			y=47
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=13
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=6
			y=43
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=18
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=11
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-1"
			type="Steel Vector"
			x=6
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-38"
			type="Steel Vector"
			x=3
			y=48
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-39"
			type="Steel Vector"
			x=4
			y=43
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-3"
			type="Steel Vector"
			x=10
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Vector"
			x=20
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Vector"
			x=7
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-42"
			type="Steel Vector"
			x=14
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-47"
			type="Steel Vector"
			x=12
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-39"
			type="Steel Vector"
			x=6
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-14"
			type="Steel Skewer"
			x=6
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-5"
			type="Steel Skewer"
			x=6
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="Ibru"
			type="Goblin Chieftain"
			x=31
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			name="Dor"
			type="Goblin Chieftain"
			x=31
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			name="Isu"
			type="Goblin Chieftain"
			x=36
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="Abag"
			type="Goblin Chieftain"
			x=30
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="Grushnu"
			type="Goblin Chieftain"
			x=36
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="Nado"
			type="Goblin Spearmaster"
			x=37
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			name="Pik"
			type="Goblin Spearmaster"
			x=29
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Vector"
			x=31
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-41"
			type="Steel Vector"
			x=35
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-15"
			type="Steel Vector"
			x=30
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-37"
			type="Steel Vector"
			x=37
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-46"
			type="Steel Vector"
			x=38
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-40"
			type="Steel Vector"
			x=33
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-41"
			type="Steel Vector"
			x=35
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-11"
			type="Steel Vector"
			x=39
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-40"
			type="Steel Vector"
			x=34
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-2"
			type="Steel Skewer"
			x=37
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=30
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=40
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=40
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-45"
			type="Steel Skewer"
			x=35
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Nymph"
			x=31
			y=20
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-80"
			type="Steel Vector"
			x=37
			y=23
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-41"
			type="Steel Vector"
			x=35
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-11"
			type="Steel Skewer"
			x=33
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-80"
			type="Steel Nymph"
			x=39
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-13"
			type="Steel Vector"
			x=30
			y=23
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-3"
			type="Steel Splicer"
			x=34
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-42"
			type="Steel Vector"
			x=34
			y=29
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-13"
			type="Steel Vector"
			x=30
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Opok"
			type="Goblin Spearmaster"
			x=33
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			name="Ipro"
			type="Goblin Chieftain"
			x=31
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="Rubru"
			type="Goblin Chieftain"
			x=29
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="Ugrob"
			type="Goblin Chieftain"
			x=36
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=34
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=30
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-2"
			type="Steel Skewer"
			x=30
			y=11
		[/unit]
		[unit]
			ai_special=guardian
			name="Khosh"
			type="Goblin Chieftain"
			x=32
			y=13
		[/unit]
		[unit]
			ai_special=guardian
			name="Arbuk"
			type="Goblin Chieftain"
			x=31
			y=12
		[/unit]
		[unit]
			ai_special=guardian
			name="Sab"
			type="Goblin Chieftain"
			x=31
			y=15
		[/unit]
		[unit]
			ai_special=guardian
			name="Tosh"
			type="Goblin Chieftain"
			x=34
			y=9
		[/unit]
		[unit]
			ai_special=guardian
			name="Ogdo"
			type="Goblin Chieftain"
			x=30
			y=15
		[/unit]
		[unit]
			ai_special=guardian
			name="Opob"
			type="Goblin Spearmaster"
			x=31
			y=10
		[/unit]
		[unit]
			ai_special=guardian
			name="Nomor"
			type="Goblin Spearmaster"
			x=32
			y=10
		[/unit]
		[unit]
			ai_special=guardian
			name="Itu"
			type="Goblin Spearmaster"
			x=34
			y=10
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-43"
			type="Steel Splicer"
			x=49
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="Usu"
			type="Goblin Chieftain"
			x=56
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="Rukho"
			type="Goblin Chieftain"
			x=60
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Vector"
			x=61
			y=30
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-44"
			type="Steel Vector"
			x=58
			y=29
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-45"
			type="Steel Vector"
			x=57
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-41"
			type="Steel Vector"
			x=59
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-2"
			type="Steel Vector"
			x=55
			y=30
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-13"
			type="Steel Vector"
			x=55
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-47"
			type="Steel Vector"
			x=56
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-13"
			type="Steel Nymph"
			x=59
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-14"
			type="Steel Nymph"
			x=55
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-41"
			type="Steel Nymph"
			x=60
			y=29
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-48"
			type="Steel Nymph"
			x=56
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-3"
			type="Steel Nymph"
			x=54
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-15"
			type="Steel Nymph"
			x=57
			y=31
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-5"
			type="Steel Nymph"
			x=54
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-15"
			type="Steel Nymph"
			x=56
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="Ushnub"
			type="Goblin Spearmaster"
			x=60
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="Ukhu"
			type="Goblin Spearmaster"
			x=53
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-44"
			type="Steel Skewer"
			x=57
			y=35
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Skewer"
			x=62
			y=32
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-1"
			type="Steel Splicer"
			x=60
			y=33
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-41"
			type="Steel Splicer"
			x=57
			y=29
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-44"
			type="Steel Splicer"
			x=57
			y=34
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=57
			y=30
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=56
			y=35
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=48
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=50
			y=28
		[/unit]
		[unit]
			ai_special=guardian
			name="Abak"
			type="Goblin Spearmaster"
			x=53
			y=20
		[/unit]
		[unit]
			ai_special=guardian
			name="Igzo"
			type="Goblin Spearmaster"
			x=50
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="Gor"
			type="Goblin Spearmaster"
			x=57
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="Apu"
			type="Goblin Spearmaster"
			x=53
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="Prado"
			type="Goblin Spearmaster"
			x=57
			y=19
		[/unit]
		[unit]
			ai_special=guardian
			name="Tok"
			type="Goblin Spearmaster"
			x=48
			y=20
		[/unit]
		[unit]
			ai_special=guardian
			name="Gaghor"
			type="Goblin Spearmaster"
			x=56
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="Sozgo"
			type="Goblin Spearmaster"
			x=48
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="Idrish"
			type="Goblin Spearmaster"
			x=56
			y=23
		[/unit]
		[unit]
			ai_special=guardian
			name="Ishnu"
			type="Goblin Spearmaster"
			x=55
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="Pragik"
			type="Goblin Spearmaster"
			x=52
			y=19
		[/unit]
		[unit]
			ai_special=guardian
			name="Ugrur"
			type="Goblin Spearmaster"
			x=50
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-3"
			type="Steel Vector"
			x=61
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-45"
			type="Steel Vector"
			x=49
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-42"
			type="Steel Vector"
			x=56
			y=26
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-14"
			type="Steel Vector"
			x=51
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Vector"
			x=58
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-39"
			type="Steel Vector"
			x=49
			y=23
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-81"
			type="Steel Vector"
			x=48
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-47"
			type="Steel Vector"
			x=59
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-80"
			type="Steel Vector"
			x=61
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Nymph"
			x=56
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Nymph"
			x=56
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Nymph"
			x=60
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-1"
			type="Steel Nymph"
			x=55
			y=20
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-37"
			type="Steel Nymph"
			x=48
			y=21
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-38"
			type="Steel Nymph"
			x=60
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=53
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=47
			y=22
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Thunderguard"
			x=58
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=52
			y=24
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=57
			y=25
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-82"
			type="Steel Splicer"
			x=50
			y=27
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=48
			y=38
		[/unit]
		[unit]
			ai_special=guardian
			type="Tesla Coil"
			x=50
			y=38
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-1"
			type="Steel Nymph"
			x=50
			y=44
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-15"
			type="Steel Skewer"
			x=53
			y=43
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-12"
			type="Steel Skewer"
			x=50
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-1"
			type="Steel Skewer"
			x=51
			y=45
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-47"
			type="Steel Skewer"
			x=51
			y=44
		[/unit]
		[unit]
			ai_special=guardian
			name="PL-80"
			type="Steel Vector"
			x=53
			y=42
		[/unit]
		[unit]
			ai_special=guardian
			name="SA-14"
			type="Steel Vector"
			x=52
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			name="SD-37"
			type="Steel Vector"
			x=49
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			name="SB-2"
			type="Steel Vector"
			x=51
			y=42
		[/unit]
		[unit]
			ai_special=guardian
			name="SC-42"
			type="Steel Vector"
			x=49
			y=40
		[/unit]
		[unit]
			ai_special=guardian
			name="Shib"
			type="Goblin Chieftain"
			x=52
			y=45
		[/unit]
		[unit]
			ai_special=guardian
			name="Ushnur"
			type="Goblin Chieftain"
			x=48
			y=42
		[/unit]
		[unit]
			ai_special=guardian
			name="Osho"
			type="Goblin Chieftain"
			x=51
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			name="Bodik"
			type="Goblin Chieftain"
			x=47
			y=41
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=52
			y=44
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=47
			y=42
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=57
			y=10
		[/unit]
		[unit]
			ai_special=guardian
			type="Gobot Scorcher"
			x=59
			y=10
		[/unit]
	[/side]

	[event]
		name=prestart

		#ifndef NORMAL
		[terrain]
			x=3
			y=70
			terrain=Cte
		[/terrain]
		#endif

		#ifdef HARD
		[terrain]
			x=2,4
			y=70,70
			terrain=Icn
		[/terrain]
		#endif
	[/event]

	[event]
		name=start
		[message]
			speaker=Io
			message="I would'nt've expected to find a cave like that under the swamp."
		[/message]
		[message]
			speaker=Amin
			message="That's because we are far underground. We passed the clay layer that is creating the swamp."
		[/message]
		[message]
			speaker=Io
			message="The good news is that we found the goblins, which means the staff is hopefully not far."
		[/message]
		[message]
			speaker=Io
			message="The bad news is that we also found whatever that weird thing up there was. I'm afraid it might not be a one-of-a-kind."
		[/message]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=4
			y=36
		[/filter]
		[if]
			[variable]
				name=trap_activated
				equals=1
			[/variable]
			[then]
				[message]
					speaker=unit
					message="There's a weird-looking orb here. Should I touch it?"
					[option]
						message="Yes, do it."
						[command]
							[remove_item]
								x,y=6,35
							[/remove_item]
							{VARIABLE trap_activated 0}
							[message]
								speaker=unit
								message="It looks like it stopped the leak that was spitting fire on the bridge."
							[/message]
						[/command]
					[/option]
					[option]
						message="No, who knows what it does."
					[/option]
				[/message]
			[/then]
			[else]
				[message]
					speaker=unit
					message="There's a weird-looking orb here. Should I touch it?"
					[option]
						message="Yes, do it."
						[command]
							[item]
								halo="scenery/flames[01~15].png"
								image="scenery/flames01.png"
								visible_in_fog=yes
								x=6
								y=35
							[/item]
							{VARIABLE trap_activated 1}
							[message]
								speaker=unit
								message="The fire caused by the leak is back."
							[/message]
						[/command]
					[/option]
					[option]
						message="No, who knows what it does."
					[/option]
				[/message]
			[/else]
		[/if]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
		[/filter]
		[filter_condition]
			[have_location]
				x=6
				y=35
				[filter_vision]
					side=1
				[/filter_vision]
			[/have_location]
		[/filter_condition]
		[scroll_to]
			x,y=6,35
		[/scroll_to]
		[message]
			speaker=unit
			message="It looks like there's a leak in a big pipe passing over the bridge that is causing a fire. We need to find a way to stop it if we don't want to burn going on the bridge."
		[/message]
	[/event]

	[event]
		name=enter_hex
		first_time_only=no
		[filter]
			x=6
			y=35
		[/filter]
		[if]
			[variable]
				name=trap_activated
				equals=1
			[/variable]
			[then]
				[sound]
					name=fire.wav
				[/sound]
				[harm_unit]
					[filter]
						x=6
						y=35
					[/filter]
					amount=10
					damage_type=fire
					animate=yes
				[/harm_unit]
				[if]
					[have_unit]
						side=1
						x=6
						y=35
					[/have_unit]
					[then]
						[message]
							speaker=unit
							message= _ "Argh! I'm burning!"
						[/message]
					[/then]
				[/if]
			[/then]
		[/if]
	[/event]

	[event]
		name=side turn
		first_time_only=no
		[if]
			[variable]
				name=trap_activated
				equals=1
			[/variable]
			[then]
				[sound]
					name=fire.wav
				[/sound]
				[harm_unit]
					[filter]
						x=6
						y=35
						side=$side_number
					[/filter]
					amount=10
					damage_type=fire
					animate=yes
				[/harm_unit]
				[if]
					[have_unit]
						side=1
						x=6
						y=35
					[/have_unit]
					[variable]
						name=side_number
						equals=1
					[/variable]
					[then]
						[message]
							speaker=unit
							message= _ "Argh! I'm burning!"
						[/message]
					[/then]
				[/if]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=20,22
			y=26,25
		[/filter]
		[if]
			[have_location]
				x=21
				y=26
				terrain=Irs^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=21
								y=26
								terrain=Irs^Pr\o
							[/terrain]
							[redraw]
								side=1
							[/redraw]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=enter_hex
		first_time_only=yes
		[filter]
			side=1
			[filter_location]
				x=32
				y=25
				radius=2
			[/filter_location]
		[/filter]
		[unit]
			type="Steel Splicer"
			x=32
			y=25
			side=2
		[/unit]
		[message]
			speaker=unit
			message= _ "A machine came out of a trap."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]

	{FAKE_WALL_2 41 20 41 21 "Steel Splicer" "Steel Nymph"}

	[event]
		name=enter_hex
		first_time_only=yes
		[filter]
			side=1
			[filter_location]
				x=38,38
				y=32,33
				radius=2
			[/filter_location]
		[/filter]
		[unit]
			type="Steel Splicer"
			x=38
			y=32
			side=2
		[/unit]
		[unit]
			type="Steel Nymph"
			x=38
			y=33
			side=2
		[/unit] 
		[message]
			speaker=unit
			message= _ "Two machines came out of a trap."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]

	{UNIT_IN_A_BOX 38 34 "Steel Skewer"}

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=45
			y=34
		[/filter]
		[if]
			[have_location]
				x=46
				y=33
				terrain=Ur^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=46
								y=33
								terrain=Ur^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
							[remove_shroud]
								x=47-51
								y=32-35
							[/remove_shroud]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=47,51,49,49
			y=34,34,32,36
		[/filter]
		
		[message]
			speaker=unit
			message="There is a lever on the wall. Should I pull it?"
			[option]
				message="Yes, do it."
				[command]
					[switch]
						variable=bridge_orientation
						[case]
							value=1
							[terrain]
								x=49,49
								y=33,35
								terrain=Qxu
							[/terrain]
							[terrain]
								x=48,49,50
								y=33,34,34
								terrain=Qxu^Bw\
							[/terrain]
							[teleport]
								[filter]
									x,y=49,33
								[/filter]
								x,y=48,33
							[/teleport]
							[teleport]
								[filter]
									x,y=49,35
								[/filter]
								x,y=50,34
							[/teleport]
							[redraw]
								side=1
							[/redraw]
							{VARIABLE bridge_orientation 2}
							[message]
								speaker=unit
								message="The bridge turned."
							[/message]
							[if]
								[have_location]
									x=52
									y=33
									terrain=Ur^Pr\
								[/have_location]
								[then]
									[terrain]
										x=52
										y=33
										terrain=Ur^Pr\o
									[/terrain]
									[redraw]
										side=1
									[/redraw]
									[message]
										speaker=unit
										message="The door also opened."
									[/message]
								[/then]
							[/if]
						[/case]
						[case]
							value=2
							[terrain]
								x=48,50
								y=33,34
								terrain=Qxu
							[/terrain]
							[terrain]
								x=48,49,50
								y=34,34,33
								terrain=Qxu^Bw/
							[/terrain] 
							[teleport]
								[filter]
									x,y=48,33
								[/filter]
								x,y=48,34
							[/teleport]
							[teleport]
								[filter]
									x,y=50,34
								[/filter]
								x,y=50,33
							[/teleport]							
							[redraw]
								side=1
							[/redraw]
							{VARIABLE bridge_orientation 3}
							[message]
								speaker=unit
								message="The bridge turned."
							[/message]
						[/case]
						[case]
							value=3
							[terrain]
								x=48,50
								y=34,33
								terrain=Qxu
							[/terrain]
							[terrain]
								x=49-49
								y=33-35
								terrain=Qxu^Bw|
							[/terrain] 
							[teleport]
								[filter]
									x,y=50,33
								[/filter]
								x,y=49,33
							[/teleport]
							[teleport]
								[filter]
									x,y=48,34
								[/filter]
								x,y=49,35
							[/teleport]								
							[redraw]
								side=1
							[/redraw]
							{VARIABLE bridge_orientation 1}
							[message]
								speaker=unit
								message="The bridge turned."
							[/message]
						[/case]
					[/switch]
				[/command]
			[/option]
			[option]
				message="No, not now."
			[/option]
		[/message]
	[/event]

	{FAKE_WALL_2 63 33 63 31 "Steel Splicer" "Steel Splicer"}

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=56
			y=28
		[/filter]
		[if]
			[have_location]
				x=56
				y=27
				terrain=Ur^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=56
								y=27
								terrain=Ur^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=60
			y=28
		[/filter]
		[if]
			[have_location]
				x=60
				y=27
				terrain=Ur^Pr/
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=60
								y=27
								terrain=Ur^Pr/o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=57,58
			y=15,14
		[/filter]
		[if]
			[have_location]
				x=57
				y=14
				terrain=Ur^Pr/
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=57
								y=14
								terrain=Ur^Pr/o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=59
			y=12
		[/filter]
		[if]
			[have_location]
				x=59
				y=11
				terrain=Ias^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=59
								y=11
								terrain=Ias^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=57,58
			y=9,9
		[/filter]
		[if]
			[have_location]
				x=58
				y=8
				terrain=Ias^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=58
								y=8
								terrain=Ias^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	{BASIC_CHEST 56 4 (axe,mace,bow,staff,sword,thunderstick)}
	{BASIC_CHEST 56 6 (axe,mace,bow,staff,sword,thunderstick)}
	{BASIC_CHEST 60 4 (axe,mace,bow,staff,sword,thunderstick)}
	{UNIT_IN_A_BOX 52 22 "Steel Vector"}
	{FAKE_WALL 53 19 "Steel Skewer"}

	[event]
		name=enter_hex
		first_time_only=yes
		[filter]
			side=1
			[filter_location]
				x=51
				y=20
				radius=2
			[/filter_location]
		[/filter]
		[unit]
			type="Steel Splicer"
			x=51
			y=20
			side=2
		[/unit]
		[message]
			speaker=unit
			message= _ "A machine came out of a trap."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]

	{UNIT_IN_A_BOX 50 19 "Gobot Scorcher"}

	[event]
		name=enter_hex
		[filter]
			side=1
			[filter_location]
				x=46
				y=25
				radius=2
			[/filter_location]
		[/filter]
		[terrain]
			x=46
			y=25
			terrain=Irs
		[/terrain] 
		{PLACE_ITEM 624 46 25}
		{PLACE_ITEM 669 46 25}
		[redraw]
			side=1
		[/redraw]
		[message]
			speaker=unit
			message="The wall was actually a door. There is something inside."
		[/message]
	[/event]

	[event]
		name=enter_hex
		first_time_only=yes
		[filter]
			side=1
			[filter_location]
				x=49
				y=27
				radius=2
			[/filter_location]
		[/filter]
		[unit]
			type="Steel Splicer"
			x=49
			y=27
			side=2
		[/unit]
		[message]
			speaker=unit
			message= _ "A machine came out of a trap."
		[/message]
		[cancel_action]
		[/cancel_action]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=49
			y=30
		[/filter]
		[if]
			[have_location]
				x=49
				y=31
				terrain=Ur^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=49
								y=31
								terrain=Ur^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=49
			y=36
		[/filter]
		[if]
			[have_location]
				x=49
				y=37
				terrain=Ur^Pr\
			[/have_location]
			[then]
				[message]
					speaker=unit
					message="There's a huge metal door. Should I open it?"
					[option]
						message="Yes, please."
						[command]
							[terrain]
								x=49
								y=37
								terrain=Ur^Pr\o
							[/terrain]
							[message]
								speaker=unit
								message="It's opened."
							[/message]
							[redraw]
								side=1
							[/redraw]
						[/command]
					[/option]
					[option]
						message="No, not now."
					[/option]
				[/message]
			[/then]
		[/if]
	[/event]

	{FAKE_WALL 51 40 "Steel Skewer"}
	{FAKE_WALL_2 54 42 54 43 "Steel Splicer" "Steel Skewer"}
	{UNIT_IN_A_BOX 51 46 "Gobot Thunderguard"}

	[event]
		name=sighted
		[filter]
			type=Gobot Thunderguard
		[/filter]
		[filter_second]
			side=1
		[/filter_second]
		[message]
			speaker=second_unit
			message="Look over there. This one looks a bit like a dwarf."
		[/message]
		[scroll_to]
			x,y=$x1,$y1
		[/scroll_to]
		[message]
			speaker=Amin
			message="Kill it! Burn it! Destroy it!!!"
		[/message]
		[message]
			speaker=Amin
			message="The whole place! Make it explode!!!"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
		[/filter]
		[filter_condition]
			[have_location]
				x=50
				y=44
				[filter_vision]
					side=1
				[/filter_vision]
			[/have_location]
		[/filter_condition]
		[scroll_to]
			x,y=50,44
		[/scroll_to]
		[message]
			speaker=unit
			message="Great... Another elevator..."
		[/message]
		[message]
			speaker=unit
			message="I assume this means that we need to go deeper to find the goblin leader. And the staff."
		[/message]
	[/event]

	[event]
		name=moveto
		first_time_only=no
		[filter]
			side=1
			x=50
			y=44
		[/filter]
		[if]
			[variable]
				name=unit.variables.hero
				equals=yes
			[/variable]
			[then]
				[message]
					speaker=unit
					message= _ "Let's go down. We need to find the goblin leader. And the staff."
				[/message]
				{END_FOOD}
				[endlevel]
					bonus=no
					result=victory
					{NEW_GOLD_CARRYOVER 100}
				[/endlevel]
			[/then]
			[else]
				[message]
					speaker=Io
					message= _ "Wait for us! We are still fighting the machines here!"
				[/message]

				[allow_undo]
				[/allow_undo]
			[/else]
		[/if]
	[/event]

	[event]
		name=victory
		{CLEAR_VARIABLE trap_activated}
		{CLEAR_VARIABLE bridge_orientation}
	[/event]

	[event]
		name=time over
		[message]
			speaker=Io
			message="No sign of the staff. The rumor about the goblins having the staff must have been only a rumor."
		[/message]
		[message]
			speaker=Io
			message="We need to start again the investigation."
		[/message]
	[/event]

	{DROPS 20 0 (axe,mace,bow,staff,sword,thunderstick,axe,mace,bow,staff,sword,thunderstick,polearm) yes 2}

	{DISABLE_NEGATIVE_INCOME 1}

	{GLOBAL_EVENTS}

[/scenario]